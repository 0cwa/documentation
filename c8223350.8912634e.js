/*! For license information please see c8223350.8912634e.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[202],{353:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return u})),n.d(t,"metadata",(function(){return s})),n.d(t,"rightToc",(function(){return p})),n.d(t,"default",(function(){return d}));var r=n(1),o=n(9),a=(n(0),n(413)),i=n(422),c=n(412),l=n(419),u=(n(417),{last_modified_on:"2021-12-21",$schema:"/.meta/.schemas/guides.json",title:"Setup VPC peering on AWS with Qovery",description:"How to peer a Qovery VPC with an existing VPC on AWS",author_github:"https://github.com/l0ck3",tags:["type: tutorial","cloud_provider: aws"],hide_pagination:!0}),s={categories:[{name:"tutorial",title:"Tutorial",description:"Simple step-by-step tutorials.",permalink:"/guides/tutorial"}],coverLabel:"Setup VPC peering on AWS with Qovery",description:"How to peer a Qovery VPC with an existing VPC on AWS",permalink:"/guides/tutorial/aws-vpc-peering-with-qovery",readingTime:"5 min read",source:"@site/guides/tutorial/aws-vpc-peering-with-qovery.md",tags:[{label:"type: tutorial",permalink:"/guides/tags/type-tutorial"},{label:"cloud_provider: aws",permalink:"/guides/tags/cloud-provider-aws"}],title:"Setup VPC peering on AWS with Qovery",truncated:!1,prevItem:{title:"Setting up Cloudflare and Custom Domain on Qovery",permalink:"/guides/tutorial/setting-up-cloudflare-and-custom-domain-on-qovery"},nextItem:{title:"Simplest way to deploy your Deno application with MongoDB database",permalink:"/guides/tutorial/simplest-way-to-deploy-deno-with-database"}},p=[{value:"Goal",id:"goal",children:[]}],b={rightToc:p};function d(e){var t=e.components,n=Object(o.a)(e,["components"]);return Object(a.b)("wrapper",Object(r.a)({},b,n,{components:t,mdxType:"MDXLayout"}),Object(a.b)("p",null,"While Qovery is all you need to deploy and run your applications in AWS, you might have existing resources in another VPC that you want to access from your Qovery applications.\nThis tutorial will show you how to set up VPC peering between the Qovery VPC and an existing one in your account."),Object(a.b)(l.a,{name:"guide",mdxType:"Assumptions"},Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},"You have an existing AWS VPC with a resource you need to access, like an RDS database"),Object(a.b)("li",{parentName:"ul"},"You have a ",Object(a.b)("a",Object(r.a)({parentName:"li"},{href:"https://hub.qovery.com/guides/tutorial/how-to-deploy-your-application-on-aws-in-30-minutes"}),"Qovery cluster ready on your AWS account")))),Object(a.b)(c.a,{type:"warning",mdxType:"Alert"},"Make sure the CIDR blocks of your two VPCs don't overlap. AWS won't allow the peering connection otherwise.",Object(a.b)("br",null),Object(a.b)("br",null),"To match this requirement, you can customize the Qovery VPC CIDR at cluster creation:",Object(a.b)("br",null),Object(a.b)("br",null),Object(a.b)("p",{align:"center"},Object(a.b)("img",{src:"/img/aws-vpc-peering-with-qovery/custom-cidr.png",alt:"Customise Qovery CIDR"}))),Object(a.b)("h2",{id:"goal"},"Goal"),Object(a.b)("p",null,"In this tutorial, we will connect an existing VPC on our AWS account with the VPC of a Qovery managed cluster.\nWe should then be able to deploy an application using a PostgreSQL RDS instance in our existing VPC."),Object(a.b)(i.a,{headingDepth:3,mdxType:"Steps"},Object(a.b)("ol",null,Object(a.b)("li",null,Object(a.b)("h4",{id:"gather-the-necessary-information"},"Gather the necessary information"),Object(a.b)("p",null,"Before we begin, you will need to gather some information. It is recommended that you keep this information at hand in a file for convenience."),Object(a.b)("h5",{id:"your-existing-vpc-id"},"Your existing VPC ID"),Object(a.b)("p",null,"To get your existing VPC ID in your AWS console, go to: ",Object(a.b)("inlineCode",{parentName:"p"},"VPC > Your VPCs"),", find the VPC you would like to use as a peering target, and copy its ID"),Object(a.b)("p",{align:"center"},Object(a.b)("img",{src:"/img/aws-vpc-peering-with-qovery/vpc-console-1.png",alt:"AWS console VPC list"})),Object(a.b)("h5",{id:"the-qovery-vpc-id"},"The Qovery VPC ID"),Object(a.b)("p",null,"You can use the same method to get the Qovery VPC ID. It should be named qovery-eks-workers."),Object(a.b)("h5",{id:"the-cidr-ranges-of-both-vpcs"},"The CIDR ranges of both VPCs"),Object(a.b)("p",null,"The CIDR range of the Qovery VCP is the one you selected at the creation of the cluster.\nYou can find it in the cluster settings on the Qovery console, under the ",Object(a.b)("inlineCode",{parentName:"p"},"Network")," tab:"),Object(a.b)("p",{align:"center"},Object(a.b)("img",{src:"/img/aws-vpc-peering-with-qovery/custom-cidr-show.png",alt:"Qovery cluster custom CIDR"})),Object(a.b)("p",null,"You can find the CIDR ranges of the existing VPC in the AWS console."),Object(a.b)("p",{align:"center"},Object(a.b)("img",{src:"/img/aws-vpc-peering-with-qovery/find-cidr.png",alt:"AWS console VPC CIDR ranges"}))),Object(a.b)("li",null,Object(a.b)("h4",{id:"create-a-peering-connection"},"Create a peering connection"),Object(a.b)("blockquote",null,Object(a.b)("p",{parentName:"blockquote"},"A VPC peering connection is a networking connection between two VPCs that enables you to route traffic between them privately.")),Object(a.b)("p",null,"In the AWS console, go to ",Object(a.b)("inlineCode",{parentName:"p"},"VPC > Peering connections")," and click on ",Object(a.b)("inlineCode",{parentName:"p"},"Create peering connection")),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},"Give it a name"),Object(a.b)("li",{parentName:"ul"},"As a requester, select your Qovery VPC"),Object(a.b)("li",{parentName:"ul"},"As an accepter, select your existing VPC"),Object(a.b)("li",{parentName:"ul"},"Click on ",Object(a.b)("inlineCode",{parentName:"li"},"Create peering connection"))),Object(a.b)("br",null),Object(a.b)("p",{align:"center"},Object(a.b)("img",{src:"/img/aws-vpc-peering-with-qovery/peering-form.png",alt:"AWS create VPC peering form"}))),Object(a.b)("li",null,Object(a.b)("h4",{id:"accept-the-peering-request"},"Accept the peering request"),Object(a.b)("p",null,"Once created, the peering connection needs to be accepted.\nOn the peering connection view, click on ",Object(a.b)("inlineCode",{parentName:"p"},"Actions")," then ",Object(a.b)("inlineCode",{parentName:"p"},"Accept request")),Object(a.b)("p",{align:"center"},Object(a.b)("img",{src:"/img/aws-vpc-peering-with-qovery/accept-peering-request.png",alt:"AWS accept VPC peering request"})),Object(a.b)("p",null,"You should see your peering connection marked as ",Object(a.b)("inlineCode",{parentName:"p"},"Active")),Object(a.b)("p",{align:"center"},Object(a.b)("img",{src:"/img/aws-vpc-peering-with-qovery/peering-active.png",alt:"AWS VPC peering active"})),Object(a.b)("p",null,"Take note of the peering connection ID. You will need it later.")),Object(a.b)("li",null,Object(a.b)("h4",{id:"update-existing-vpc-route-table"},"Update existing VPC route table"),Object(a.b)("p",null,"In the AWS console, go to ",Object(a.b)("inlineCode",{parentName:"p"},"VPC > Route Tables"),".\nYou can filter the list using the IDs you noted at step 1 to find the routes table for each VPC."),Object(a.b)("p",null,"For your existing VPC edit the route table:"),Object(a.b)("p",{align:"center"},Object(a.b)("img",{src:"/img/aws-vpc-peering-with-qovery/existing-rt.png",alt:"AWS VPC Route Table"})),Object(a.b)("p",null,"Click on the ",Object(a.b)("inlineCode",{parentName:"p"},"Edit routes")," button then ",Object(a.b)("inlineCode",{parentName:"p"},"Add route"),". "),Object(a.b)("p",{align:"center"},Object(a.b)("img",{src:"/img/aws-vpc-peering-with-qovery/qovery-rt-add.png",alt:"AWS VPC Qovery Route Table add route"})),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},"As a destination, enter the CIDR of your Qovery VPC"),Object(a.b)("li",{parentName:"ul"},"As a target, select the Peering connection you created earlier")),Object(a.b)("p",null,"Click ",Object(a.b)("inlineCode",{parentName:"p"},"Save changes"),"."),Object(a.b)(c.a,{type:"warning",mdxType:"Alert"},"Do not alter existing routes. Make sure you are adding a new one.")),Object(a.b)("li",null,Object(a.b)("h4",{id:"update-qovery-vpc-route-table"},"Update Qovery VPC route table"),Object(a.b)("p",null,"This part needs to be done through the Qovery console. "),Object(a.b)(c.a,{type:"warning",mdxType:"Alert"},"Do not alter edit the Qovery VPC route table directly on the AWS console. Your changes would be lost next time we update your cluster."),Object(a.b)("p",null,"In the cluster settings, under the ",Object(a.b)("inlineCode",{parentName:"p"},"Network")," tab, click ",Object(a.b)("inlineCode",{parentName:"p"},"ADD ROUTE")),Object(a.b)("p",{align:"center"},Object(a.b)("img",{src:"/img/aws-vpc-peering-with-qovery/qovery-rt.png",alt:"AWS VPC Qovery Route Table add route"})),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},"As a destination, enter the CIDR of your existing VPC"),Object(a.b)("li",{parentName:"ul"},"As a target, enter the ID of the peering connection you created earlier"),Object(a.b)("li",{parentName:"ul"},"You can put anything you want as a description.")),Object(a.b)("p",{align:"center"},Object(a.b)("img",{src:"/img/aws-vpc-peering-with-qovery/qovery-rt-added.png",alt:"AWS VPC Qovery Route Table add route"}))),Object(a.b)("li",null,Object(a.b)("h4",{id:"update-the-security-groups"},"Update the security groups"),Object(a.b)("p",null,"Our two VPCs are now connected, but we still need to update the security groups to allow communication between the Qovery applications and your existing resources."),Object(a.b)("p",null,"What rules to put on your security groups depends on what you are trying to achieve.\nIn our case, we would like to access an RDS instance from our Qovery applications."),Object(a.b)("p",null,"We will edit the RDS security group in our existing VPC to add an inbound rule allowing PostgreSQL traffic from our Qovery instances: "),Object(a.b)("p",{align:"center"},Object(a.b)("img",{src:"/img/aws-vpc-peering-with-qovery/pg-inbound-rule.png",alt:"AWS Security Group inbound rules"}))),Object(a.b)("li",null,Object(a.b)("h4",{id:"deploy-an-application"},"Deploy an application"),Object(a.b)("p",null,"You should now be able to deploy an application using the RDS PostgreSQL database on your Qovery cluster.\nRefer to ",Object(a.b)("a",Object(r.a)({parentName:"p"},{href:"/guides/getting-started/deploy-your-first-application/"}),"this guide")," if you need help deploying an application on Qovery.")))),Object(a.b)("p",null,"You can learn more about VPC peering on AWS here: ",Object(a.b)("a",Object(r.a)({parentName:"p"},{href:"https://docs.aws.amazon.com/vpc/latest/peering/what-is-vpc-peering.html"}),"https://docs.aws.amazon.com/vpc/latest/peering/what-is-vpc-peering.html")))}d.isMDXComponent=!0},411:function(e,t,n){var r;!function(){"use strict";var n={}.hasOwnProperty;function o(){for(var e=[],t=0;t<arguments.length;t++){var r=arguments[t];if(r){var a=typeof r;if("string"===a||"number"===a)e.push(r);else if(Array.isArray(r)&&r.length){var i=o.apply(null,r);i&&e.push(i)}else if("object"===a)for(var c in r)n.call(r,c)&&r[c]&&e.push(c)}}return e.join(" ")}e.exports?(o.default=o,e.exports=o):void 0===(r=function(){return o}.apply(t,[]))||(e.exports=r)}()},412:function(e,t,n){"use strict";n(415);var r=n(0),o=n.n(r),a=n(411),i=n.n(a);n(131);t.a=function(e){var t=e.children,n=e.classNames,r=e.fill,a=e.icon,c=e.type,l=null;switch(c){case"danger":l="alert-triangle";break;case"success":l="check-circle";break;case"warning":l="alert-triangle";break;default:l="info"}return o.a.createElement("div",{className:i()(n,"alert","alert--"+c,{"alert--fill":r,"alert--icon":!1!==a}),role:"alert"},!1!==a&&o.a.createElement("i",{className:i()("feather","icon-"+(a||l))}),t)}},413:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return g}));var r=n(0),o=n.n(r);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var u=o.a.createContext({}),s=function(e){var t=o.a.useContext(u),n=t;return e&&(n="function"==typeof e?e(t):c({},t,{},e)),n},p=function(e){var t=s(e.components);return o.a.createElement(u.Provider,{value:t},e.children)},b={inlineCode:"code",wrapper:function(e){var t=e.children;return o.a.createElement(o.a.Fragment,{},t)}},d=Object(r.forwardRef)((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,i=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),p=s(n),d=r,g=p["".concat(i,".").concat(d)]||p[d]||b[d]||a;return n?o.a.createElement(g,c({ref:t},u,{components:n})):o.a.createElement(g,c({ref:t},u))}));function g(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,i=new Array(a);i[0]=d;var c={};for(var l in t)hasOwnProperty.call(t,l)&&(c[l]=t[l]);c.originalType=e,c.mdxType="string"==typeof e?e:r,i[1]=c;for(var u=2;u<a;u++)i[u]=n[u];return o.a.createElement.apply(null,i)}return o.a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},414:function(e,t,n){"use strict";var r=n(1),o=n(0),a=n.n(o),i=n(39),c=n(418),l=n(19),u=n.n(l);t.a=function(e){var t,n=e.to,l=e.href,s=n||l,p=Object(c.a)(s),b=Object(o.useRef)(!1),d=u.a.canUseIntersectionObserver;return Object(o.useEffect)((function(){return!d&&p&&window.docusaurus.prefetch(s),function(){d&&t&&t.disconnect()}}),[s,d,p]),s&&p?a.a.createElement(i.b,Object(r.a)({},e,{onMouseEnter:function(){b.current||(window.docusaurus.preload(s),b.current=!0)},innerRef:function(e){var n,r;d&&e&&p&&(n=e,r=function(){window.docusaurus.prefetch(s)},(t=new window.IntersectionObserver((function(e){e.forEach((function(e){n===e.target&&(e.isIntersecting||e.intersectionRatio>0)&&(t.unobserve(n),t.disconnect(),r())}))}))).observe(n))},to:s})):a.a.createElement("a",Object(r.a)({},e,{href:s}))}},415:function(e,t,n){var r=n(12);r(r.P,"Array",{fill:n(420)}),n(74)("fill")},416:function(e,t,n){var r=n(25).f,o=Function.prototype,a=/^\s*function ([^ (]*)/;"name"in o||n(10)&&r(o,"name",{configurable:!0,get:function(){try{return(""+this).match(a)[1]}catch(e){return""}}})},417:function(e,t,n){"use strict";var r=n(0),o=n.n(r),a=n(414),i=n(411),c=n.n(i);n(132);t.a=function(e){var t=e.children,n=e.className,r=e.badge,i=e.leftIcon,l=e.rightIcon,u=e.size,s=e.target,p=e.to,b=c()("jump-to","jump-to--"+u,n),d=o.a.createElement("div",{className:"jump-to--inner"},o.a.createElement("div",{className:"jump-to--inner-2"},i&&o.a.createElement("div",{className:"jump-to--left"},o.a.createElement("i",{className:"feather icon-"+i})),o.a.createElement("div",{className:"jump-to--main"},r?o.a.createElement("span",{className:"badge badge--primary badge--right"},r):"",t),o.a.createElement("div",{className:"jump-to--right"},o.a.createElement("i",{className:"feather icon-"+(l||"chevron-right")+" arrow"}))));return s?o.a.createElement("a",{href:p,target:s,className:b},d):o.a.createElement(a.a,{to:p,className:b},d)}},418:function(e,t,n){"use strict";function r(e){return!1===/^(https?:|\/\/)/.test(e)}n.d(t,"a",(function(){return r}))},419:function(e,t,n){"use strict";n(416);var r=n(0),o=n.n(r),a=n(412);t.a=function(e){var t=e.children,n=e.name;return o.a.createElement(a.a,{type:"info",fill:!0,icon:!1,rounded:!0,className:"list--icons list--icons--arrow list--tight list--indent margin-bottom--lg"},o.a.createElement("p",{class:"text--lg margin-bottom--sm",style:{marginTop:"-0.25em"}},"Before you begin, this ",n||"page"," assumes the following:"),t)}},420:function(e,t,n){"use strict";var r=n(27),o=n(75),a=n(26);e.exports=function(e){for(var t=r(this),n=a(t.length),i=arguments.length,c=o(i>1?arguments[1]:void 0,n),l=i>2?arguments[2]:void 0,u=void 0===l?n:o(l,n);u>c;)t[c++]=e;return t}},421:function(e,t,n){"use strict";var r=n(423),o=n(51);function a(e,t){return t.encode?t.strict?r(e):encodeURIComponent(e):e}t.extract=function(e){return e.split("?")[1]||""},t.parse=function(e,t){var n=function(e){var t;switch(e.arrayFormat){case"index":return function(e,n,r){t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===r[e]&&(r[e]={}),r[e][t[1]]=n):r[e]=n};case"bracket":return function(e,n,r){t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==r[e]?r[e]=[].concat(r[e],n):r[e]=[n]:r[e]=n};default:return function(e,t,n){void 0!==n[e]?n[e]=[].concat(n[e],t):n[e]=t}}}(t=o({arrayFormat:"none"},t)),r=Object.create(null);return"string"!=typeof e?r:(e=e.trim().replace(/^(\?|#|&)/,""))?(e.split("&").forEach((function(e){var t=e.replace(/\+/g," ").split("="),o=t.shift(),a=t.length>0?t.join("="):void 0;a=void 0===a?null:decodeURIComponent(a),n(decodeURIComponent(o),a,r)})),Object.keys(r).sort().reduce((function(e,t){var n=r[t];return Boolean(n)&&"object"==typeof n&&!Array.isArray(n)?e[t]=function e(t){return Array.isArray(t)?t.sort():"object"==typeof t?e(Object.keys(t)).sort((function(e,t){return Number(e)-Number(t)})).map((function(e){return t[e]})):t}(n):e[t]=n,e}),Object.create(null))):r},t.stringify=function(e,t){var n=function(e){switch(e.arrayFormat){case"index":return function(t,n,r){return null===n?[a(t,e),"[",r,"]"].join(""):[a(t,e),"[",a(r,e),"]=",a(n,e)].join("")};case"bracket":return function(t,n){return null===n?a(t,e):[a(t,e),"[]=",a(n,e)].join("")};default:return function(t,n){return null===n?a(t,e):[a(t,e),"=",a(n,e)].join("")}}}(t=o({encode:!0,strict:!0,arrayFormat:"none"},t));return e?Object.keys(e).sort().map((function(r){var o=e[r];if(void 0===o)return"";if(null===o)return a(r,t);if(Array.isArray(o)){var i=[];return o.slice().forEach((function(e){void 0!==e&&i.push(n(r,e,i.length))})),i.join("&")}return a(r,t)+"="+a(o,t)})).filter((function(e){return e.length>0})).join("&"):""}},422:function(e,t,n){"use strict";var r=n(0),o=n.n(r),a=(n(411),n(421)),i=n.n(a);n(133);t.a=function(e){var t=e.children,n=e.headingDepth,a=e.hideFeedbackQuestion,c="undefined"!=typeof window?window.location:null,l={title:"Tutorial on "+c+" failed",body:"The tutorial on:\n\n"+c+"\n\nHere's what went wrong:\n\n\x3c!-- Insert command output and details. Thank you for reporting! :) --\x3e"},u="https://github.com/qovery/documentation/issues/new?"+i.a.stringify(l),s=Object(r.useState)(null),p=s[0],b=s[1];return o.a.createElement("div",{className:"steps steps--h"+n},t,!a&&!p&&o.a.createElement("div",{className:"steps--feedback"},"How was it? Did this tutorial work?\xa0\xa0",o.a.createElement("span",{className:"button button--sm button--primary",onClick:function(){return b("yes")}},"Yes"),"\xa0\xa0",o.a.createElement("a",{href:u,target:"_blank",className:"button button--sm button--primary"},"No")),"yes"==p&&o.a.createElement("div",{className:"steps--feedback steps--feedback--success"},"Thanks! If you're enjoying Qovery please consider ",o.a.createElement("a",{href:"https://github.com/qovery/documentation/",target:"_blank"},"starring our Github repo"),"."))}},423:function(e,t,n){"use strict";e.exports=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()}))}}}]);